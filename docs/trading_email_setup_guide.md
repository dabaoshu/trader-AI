# 📧 trader-AI 交易日报邮件系统使用指南

## 🎯 系统概述

trader-AI 交易日报邮件系统可以在每个交易日的9:25-9:29时间段自动执行股票分析，并将分析结果、推荐股票信息、买卖点建议等以精美的HTML日报形式发送到您的邮箱。

## 📋 功能特性

### ✅ 自动化功能
- **定时执行**: 每个交易日9:25-9:29自动分析
- **智能调度**: 自动判断交易日，非交易日不执行
- **错误重试**: 多时间点执行，确保报告发送成功
- **盘后补发**: 15:05备用补发时间

### 📊 分析内容
- **竞价分析**: 集合竞价数据深度分析
- **技术分析**: 多指标综合技术分析
- **股票推荐**: 智能筛选高质量股票
- **交易建议**: 买点、卖点、止损、目标价
- **风险控制**: 仓位建议和风险提示

### 📧 邮件特性
- **精美HTML**: 专业的邮件模板设计
- **数据详实**: 完整的分析数据和图表
- **移动适配**: 支持手机、电脑查看
- **附件支持**: JSON格式详细数据附件

## 🔧 配置步骤

### 1. 邮箱服务设置

#### QQ邮箱配置 (推荐)
1. 登录QQ邮箱 → 设置 → 账户
2. 开启"SMTP服务"
3. 生成授权码（非QQ密码）
4. 记录邮箱地址和授权码

#### 163邮箱配置
1. 登录163邮箱 → 设置 → 客户端授权密码
2. 开启"SMTP服务" 
3. 设置客户端授权密码
4. 记录邮箱地址和授权密码

#### Gmail配置
1. 开启两步验证
2. 生成应用专用密码
3. 使用应用密码而非Gmail密码

### 2. 环境变量配置

编辑 `.env` 文件：
```bash
# 发送邮箱
SENDER_EMAIL=your_email@qq.com

# 邮箱授权码/密码
SENDER_PASSWORD=your_app_password

# 接收邮箱  
RECIPIENT_EMAIL=recipient@email.com

# 邮件服务商
EMAIL_PROVIDER=qq
```

### 3. 测试邮件系统

```bash
# 测试邮件发送
python3 email_config.py

# 测试日报生成
python3 daily_report_generator.py test
```

## 🚀 启动方式

### 方式一：直接启动 (前台运行)
```bash
python3 trading_day_scheduler.py
```

### 方式二：守护进程 (后台运行)
```bash
python3 trading_day_scheduler.py --daemon
```

### 方式三：系统服务 (推荐)
```bash
# 使用生成的启动脚本
./start_scheduler.sh
```

### 方式四：测试模式
```bash
# 立即执行一次(忽略时间限制)
python3 trading_day_scheduler.py --test
```

## 📊 日报内容详解

### 📈 邮件标题
`📊 trader-AI 交易日报 - 2025-06-29`

### 🎯 市场概况
- 分析股票总数
- 推荐股票数量  
- 强烈推荐数量
- 平均评分

### ⚡ 竞价分析
- 平均竞价比率
- 高开/平开/低开股票统计
- 市场整体情绪判断

### 🏆 推荐股票列表
每只推荐股票包含：
- **基础信息**: 代码、名称、价格、市场
- **评分数据**: 综合评分、技术评分、竞价评分
- **竞价分析**: 竞价比率、缺口类型、资金偏向
- **技术指标**: RSI、量比、均线状态
- **交易建议**: 入场价、止损价、目标价、仓位建议
- **策略指导**: 具体操作建议

### 📋 风险提示
- 投资风险警示
- 操作建议指导
- 仓位控制要求

## ⏰ 执行时间表

| 时间 | 任务 | 说明 |
|------|------|------|
| 9:25 | 主要执行 | 竞价结束后立即分析 |
| 9:26-9:29 | 重试执行 | 确保发送成功 |
| 9:30 | 备用执行 | 开盘后补发 |
| 15:05 | 盘后补发 | 如当日未发送则补发 |

## 🔍 状态监控

### 查看运行状态
```bash
python3 trading_day_scheduler.py --status
```

### 查看日志
```bash
tail -f /Users/yang/trading_scheduler.log
```

### 停止调度器
```bash
# 如果是前台运行，直接按 Ctrl+C
# 如果是后台运行，需要查找进程并kill
ps aux | grep trading_day_scheduler
kill <进程ID>
```

## 📁 生成文件说明

| 文件 | 位置 | 说明 |
|------|------|------|
| 日志文件 | `/Users/yang/trading_scheduler.log` | 系统运行日志 |
| 数据文件 | `/Users/yang/daily_report_YYYYMMDD_HHMMSS.json` | 详细分析数据 |
| 启动脚本 | `/Users/yang/start_scheduler.sh` | 系统启动脚本 |

## 🐛 常见问题

### 邮件发送失败
1. **检查网络连接**
2. **验证邮箱配置**: 确保授权码正确
3. **检查邮件服务商**: 确认SMTP服务已开启
4. **查看详细日志**: 检查具体错误信息

### 非交易日执行
- 系统自动判断交易日，周末和节假日不会执行
- 可使用测试模式强制执行

### 重复发送问题
- 系统有防重复机制，每天只发送一次
- 如需重新发送，可使用测试模式

### 分析数据异常
- 检查网络连接
- 验证BaoStock和AKShare数据源
- 查看系统日志确定具体问题

## 💡 使用建议

### 最佳实践
1. **提前配置**: 在交易前一晚配置好系统
2. **测试验证**: 使用测试模式验证系统正常
3. **定期检查**: 定期查看日志确认系统运行
4. **备用邮箱**: 可配置多个接收邮箱

### 安全建议
1. **密码保护**: 妥善保管邮箱授权码
2. **权限控制**: 限制.env文件访问权限
3. **定期更新**: 定期更换邮箱授权码

### 性能优化
1. **网络稳定**: 确保网络连接稳定
2. **系统资源**: 保证足够的系统资源
3. **数据源**: 选择稳定的数据源接口

## 🆕 版本更新

### v1.0 功能
- ✅ 基础邮件发送
- ✅ 定时任务调度
- ✅ 交易日报生成
- ✅ 竞价数据分析

### 未来计划
- 📊 增加更多技术指标
- 📱 支持微信、钉钉推送
- 🤖 AI驱动的个性化推荐
- 📈 历史预测准确率统计

---

**🎯 总结：通过这套自动化系统，您可以每天在开盘前4分钟收到专业的股票分析日报，包含精选推荐、买卖点建议和风险控制，大大提升投资决策效率！**